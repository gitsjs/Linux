



# Linux基础

## 一、目录介绍

/:表示根目录

/bin:(binary)存放二进制文件

/etc:存放Linux的所有配置文件

/home:是所有非root用户的家目录

/root:root用户的家目录

/sbin:(shell sbin)类似bin目录，存放二进制文件，里面指令只能root用户执行

/usr:存放用户自己安装的软件

/var:(variable)存放Linux下的一些日志文件，在实际开发中一些公司也会把Apache或Nignx的站点目录放在var中

## 二、基础指令

### 1.简单指令

#### ls

ls是list缩写，作用：列出指定目录中的文件和文件夹

语法1：列出当前目录的文件和文件夹

```
ls
```

语法2：列出指令目录的文件和文件夹

```
ls /root
```

语法3：以列表形式列出指令目录的所有文件和文件夹

-l list 以列表形式打印目录

-a all 包含隐藏文件 隐藏文件以 . 开头

```
ls -la /root
```

#### clear

作用：清屏

#### su

作用：切换用户

#### cd

作用：切换目录

#### pwd

作用：打印当前工作路径

### 2.文档操作指令

#### touch

作用：创建文件

当前目录下创建文件

```
touch file.txt
```

在根目录下创建文件

```
touch /php.txt


```

#### mkdir

作用：创建目录

```
mkdir php
```

#### cp

作用：复制文件或者文件夹

```
cp /file.txt /home/admin
```

由于复制目录的时候，还要复制目录中含有的其他文件，所以需要使用递归复制

-r 递归复制

```
cp -r php /home/admin
```

##### mv

作用：移动文件(move)

```
mv /home/admin/file.txt /root/
```

复制并重命名

```
mv /root/file.txt /root/php.txt
```

#### rm

作用：删除文件

-r 递归 用于对目录进行操作

-f force 强制

```
rm file.txt

rm -f file.txt

rm -rf php
```

### 3.文档查看指令

#### head

作用：从文件头部第几行开始查看，如果不指定行数为默认10行

```
head -5 /root/install.log
```

#### tail

作用：查看文件的末尾内容

```
tail -5 /root/install.log
```

#### cat

作用：查看文件的所有内容 正序

```
cat 文件路径1 文件路径2 ......
```

#### tac

作用：查看文件的所有内容 倒序

```
tac 文件路径1 文件路径2 ......
```

#### vim

作用：vim编辑器，用于编辑文件

```
vim file.txt
```

### 4.关机重启指令

#### reboot

作用：重启

#### shutdown

作用：关机

now 现在关机

```
shutdown -h now
```

+m minute 分钟数 

```
shutdown -h +5
```

#### halt

作用：关机(关闭内存)

### 5.进阶指令

#### man

作用：查看指令的用法

```
man ls
```

-- help 显示指令的选项

```
ls --help 
```

#### du

作用：显示目录对磁盘的使用情况

```
du ~
```

-h 高可读性显示数据(带单位)

-s summary 汇总统计(只显整个目录的占用情况)

```
du -sh ~
```

#### df

作用：查看磁盘剩余空间 

```
df -h 
```

-m以mb为单位查看磁盘使用情况

```
df -m
```

#### free

作用：查看内存使用情况

```
free -m
```

#### find

作用：根据条件查看文档的所有位置

-name:根据文件名找

-type:根据文件类型找(f:file 普通文件，d:directory 文件夹，s:socket 套接字文件)

-user:根据拥有者查找

-group:根据用户组查找

-size:根据大小查找

```
find / -name httpd.conf -type f

find / -name *.conf -type f
```

*是通配符，表示模糊查找

#### ps

作用：查看进程信息

-e:和-A一样，查看全部

-f:查看完信息

```
ps -ef
```

UID 进程所属用户

PID 进程ID

PPID 父进程ID

C cpu使用情况

STIME 开始时间

TTY 终端设备编号

TIME 进程持续运行的时间

CMD 进程的名称或所在位置

**关闭进程:kill PID**

#### service 

作用：管理服务(start/stop/restart)

要启动的服务，对应的服务必须存在于/etc/init.d目录下

#### grep

作用：搜索、过滤、针对文件内容或者指令的输出结果进行筛选

```
grep php php.txt
```

-v 排除

```
grep -v php php.txt
```

-E 扩展 同时搜索多个条件

```
grep -E "php|root" php.txt
```

#### wc

作用：统计文件内容里的行、单词数、字节数

-l line 行

-w word 单词

-c count 以Byte字节为单位进行统计

```
wc php.txt

wc -lwc php.txt
```

#### | 管道

程序A的输出是程序B的输入

管道符 | 

语法：程序A|程序B

```
ps -ef | grep 'httpd'

cat /etc/passwd | wc -l
```

## 三、vim编辑器

vi是Linux中的文本编辑器

vim是vi的升级版，主要用于编写代码

语法：

vim 文件路径

vim +/关键字 文件路径

vim +/行号 文件路径

### 三种模式

命令模式：光标移动、模式切换、删除、查找、替换、复制、粘贴等功能

编辑模式：编辑文本内容

末行模式：保存文件，退出编辑器

#### 命令模式

1.光标移动操作

| 快捷键 | 说明           |
| ------ | -------------- |
| ^      | 光标移动到行首 |
| $      | 光标移动到行尾 |
| gg     | 光标移动到首行 |
| G      | 光标移动到末行 |
| PgUp   | 向上翻页       |
| PgDn   | 向下翻页       |
| 行号 G | 定位到行       |

2.复制粘贴操作

| 快捷键  | 说明     |
| ------- | -------- |
| yy      | 复制单行 |
| 行数 yy | 复制多行 |
| p       | 粘贴     |

3.剪切删除操作

| 快捷键  | 说明     |
| ------- | -------- |
| dd      | 剪切单行 |
| 行数 dd | 剪切多行 |
| D       | 置空剪切 |

4.撤销重做操作

| 快捷键 | 说明     |
| ------ | -------- |
| u      | 撤销删除 |
| ctrl+r | 重做操作 |

一直按u可以恢复到本次打开文件时的状态

一直按ctrl+r可以恢复到本次编辑文件时的最新状态

#### 末行模式

`:`或`/` 进入末行模式，按一次`ESC`大概2秒退出模式，双击`ESC`立即退出模式

| 快捷键  | 说明                                                         |
| ------- | ------------------------------------------------------------ |
| :w      | 保存                                                         |
| :q      | 退出                                                         |
| :q!     | 强制退出                                                     |
| :wq     | 保存退出                                                     |
| /关键词 | 搜索关键词。按n移动到下一个搜索位置，按N移动到上一个搜索位置 |
| :s      | 替换。:s/关键词/新内容：替换第1处符合关键词的内容，:s/关键词/新内容/g：替换本行所有符合关键词的内容，:%s/关键词/新内容：替换每一行中第一处符合关键词的内容，:%s/关键词/新内容/g：替换每一行，每一处符合关键词的内容 |
| :set nu | 显示行号。修改vim配置文件，默认加上行号：当前用户的家目录/.vimrc(~/.vimrc) |
| :nohl   | 取消高亮                                                     |

#### 编辑模式

`i`或者`a`进入编辑模式 ，按一次`ESC`退出模式

#### 异常退出

如果在编辑文件时异常退出，会导致该文件无法再次编辑，需要删除编辑时生成的临时文件

```
rm .filename.swp
```

## 四、用户与用户组

#### 用户管理

| 路径        | 说明                          |
| ----------- | ----------------------------- |
| /etc/passwd | 存储用户的关键信息,不包含密码 |
| /etc/group  | 存储用户组的关键信息          |
| /etc/shadow | 存储用户的密码信息(加密密码)  |

认识passwd文件

```
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
```

root 用户名：创建的用户名称

x 密码：此密码的位置一般为X代替，表示占位

0 用户ID：用户的标识符

0 用户组ID：用户组的标识符(主组)

root 注释：用来描述用户的作用

/root 家目录：家目录路径，用户登陆后系统默认的工作路径

bin/bash 解释器：用户输入指令后，指令的内容会交给解释器处理。/bin/bash:该用户可以登陆，/sbin/noligin：该用户不可以登陆。

##### 1.新增用户

语法：`useradd [选项] 用户名`

-g：用户主组

-G：用户附加组

-u：设置用户id

-c：编写用户注释

-s：设置帐号所用的shell解释器

-d：设置用户的家目录

-n：取消建立以用户名所创建的组

```
useradd -g 500 -G 500 -u 500 -c '注释' -s /sbin/nologin test 
```

##### 2.修改用户

语法：`usermod [选项] 用户名  ` 

-l：修改用户名

-g：用户主组

-G：用户附加组

-u：设置用户id

-c：编写用户注释

-s：设置帐号所用的shell解释器

-d：设置用户的家目录

```
usermod -l newusername username
```

##### 3.设置密码

```
passwd username
```

##### 4.删除用户

-r 删除用户的同时删掉家目录

```
userdel -r usrname
```

#### 用户组管理

用户组管理文件：/etc/group

```
admin:x:1000:admin
```

`admin` 组名，默认与用户同名

`x 组密码`，x代表占位符，一般很少设置组密码

`1000` 组id，唯一标识符

`admin` 组成员

##### 1.新增用户组

-g 手动设置用户组id 默认为500

```
groupadd -g 501 admin
```

##### 2.修改用户组

-g 修改用户组id

-n 修改组名

```
groupname -g 501  -n admins admin
```

##### 3.删除用户组

```
groupdel admin
```

#### 权限管理

##### 1.权限介绍

| 权限 | 单个文件                             | 文件夹                             |
| ---- | ------------------------------------ | ---------------------------------- |
| 读   | 用户能否查看文件的内容               | 用户能否列出目录结构               |
| 写   | 用户能否编辑内容，写需要读的权限支持 | 用户能否复制、粘贴、新建、删除文件 |
| 执行 | 用户能否执行当前脚本                 | 用户能否在当前目录下执行指令       |

##### 2.身份介绍

| 身份   | 说明                                 |
| ------ | ------------------------------------ |
| Owner  | 所有者，文档是由该用户创建           |
| Group  | 所属组，与文件的创建同组用户         |
| Others | 其他人，除了创建者和同组用户以外的人 |
| Root   | 超级用户，默认拥有一切权限           |

##### 3.权限解读

查看文件权限：`ll`

```
-rw-------
-rw-r--r--
drwxr-xr-x
drwxrwxrwx
```

文件类型(**第1位**)+所有者权限(**2~3位**)+用户组权限(**5~7位**)+其他人权限(**8~9位**)

权限设置顺序是：**rwx 读写执行**

##### 4.权限设置

语法：`chmod [-R] 权限模式 文件路径`

-R 递归设置权限(文件夹时使用)

1、字母形式

语法：`chmod (身份类型)(操作类型)(权限种类) 文件路径`

| 身份类型 | 说明                |
| -------- | ------------------- |
| u        | user，所有者身份    |
| g        | group，同组用户身份 |
| o        | others，其他人身份  |
| a        | all，所有人         |

| 操作类型 | 说明                       |
| -------- | -------------------------- |
| +        | 赋予用户某种权限(相对设置) |
| -        | 剥夺用户某种权限(相对设置) |
| =        | 设置用户具体权限(绝对设置) |

| 权限种类 | 说明       |
| -------- | ---------- |
| rwx      | 读 写 执行 |
| -        | 没有权限   |

```
chmod u+rwx,g+rwx,o+rwx file.txt

chmod u=rwx,g=rwx,o=rwx file.txt
```

| 文件颜色 | 说明       |
| -------- | ---------- |
| 黑色     | 文件       |
| 蓝色     | 目录       |
| 绿色     | 可执行文件 |

取消所有权限：

```
chmod a=- file.txt 

chmod =- file.txt
```

2、数字模式

语法：`chmod [-R] 权限值 文件路径`

```
chmod 777 file.txt
```

第一个7：所有者权限值

第二个7：同组用户权限值

第三个7：其他人权限值

| 数值 | 权限     | 目录列表 |
| ---- | -------- | -------- |
| 0    | 没有权限 | ---      |
| 1    | 执行     | --x      |
| 2    | 写       | -w-      |
| 3    | 写 执行  | -wx      |
| 4    | 读       | r--      |
| 5    | 读 执行  | r-x      |
| 6    | 读写     | rw-      |
| 7    | 所有权限 | rwx      |

3、默认权限

文件：644

文件夹：755

在Linux中记录了一个掩码umask=022，文件权限=666-掩码，文件夹权限=777-掩码。

##### 5.属主(所有者)和属组(所有组)

```
drwxr-xr-x.  2 root  root      4096 12月 23 16:24 公共
```

第一个root：属主

第二个root：属组

1、chown

作用：修改所有者

`chown [-R] 新用户名 文件路径`

2、chgrp

作用：修改所有组

`chgrp [-R] 新用户名 文件路径`

##### 6.sudo

作用：赋予普通用户高级指令，halt、shutdown、reboot

使用sudo之前需要修改sudo的配置文件：`/etc/sudoers`

```
## Allow root to run any commands anywhere
root    ALL=(ALL)       ALL
```

root	用户名

ALL=(ALL)	登陆主机=（ALL代表root身份）

ALL		代表所有指令

语法：`sudo 指令名 指令的选项和值`

```
sudo useradd username
```

扩展：

在配置sudo时，建议不要单独写指令名，写指令程序的详细路径

查询指令路径：which 指令名

```
which useradd
```



